// Initialize grid: clear and set size
clear
0 0
rows = 30
1 0
30
cols = 3
1 0
3
width = 9
1 0
9
rows = 3
1 0
3
print
8 2
    |    A    |    B    |    C    |
----+---------+---------+---------+
  1 |         |         |         |
----+---------+---------+---------+
  2 |         |         |         |
----+---------+---------+---------+
  3 |         |         |         |
----+---------+---------+---------+
rows
1
3
cols
1
3
width
1
9
// subtotal
// Test simple setting of NumberCell and TextCell
a1 = -7
0 0
b1 = "test"
0 0
a1
1 0.5
-7
b1
1 0.5
"test"
value a1
1 0.5
-7.0
display b1
1 0.5
test
print
8 2
    |    A    |    B    |    C    |
----+---------+---------+---------+
  1 |     -7.0|     test|         |
----+---------+---------+---------+
  2 |         |         |         |
----+---------+---------+---------+
  3 |         |         |         |
----+---------+---------+---------+
// subtotal
// Test expr, truncating, and a special TextCell case
clear
0 0
rows = 3
0 0
cols = 3
0 0
a1 = "This is too long"
0
expr a1
1 1
"This is too long"
print
8 1
    |    A    |    B    |    C    |
----+---------+---------+---------+
  1 |This is t|         |         |
----+---------+---------+---------+
  2 |         |         |         |
----+---------+---------+---------+
  3 |         |         |         |
----+---------+---------+---------+
clear a1
0
a2 = "3 != 2"
0 0
print
8 1
    |    A    |    B    |    C    |
----+---------+---------+---------+
  1 |         |         |         |
----+---------+---------+---------+
  2 |   3 != 2|         |         |
----+---------+---------+---------+
  3 |         |         |         |
----+---------+---------+---------+
a2
1
"3 != 2"
// subtotal
// Test decimals, longer expressions with constants
clear
0
a1 = ( 2.7182818 )
0
a2 = ( 1.0 / 2.0 * 3.5 + .5 - 0.75 )
0
a3 = ( 4.0 * 0.5 * 2 / 1 - 4 - 0 + 0 )
0
print
8 3
    |    A    |    B    |    C    |
----+---------+---------+---------+
  1 |2.7182818|         |         |
----+---------+---------+---------+
  2 |      1.5|         |         |
----+---------+---------+---------+
  3 |      0.0|         |         |
----+---------+---------+---------+
// subtotal
// Test simple cell references and expressions
clear
0 0
a1 = ( b1 * c1 - 4. )
0 0
b1 = 2.2
0 0
c1 = .5
0 0
a2 = ( c1 * a1 )
0 0
b2 = ( c1 - a2 )
0 0
a1
1 1
( b1 * c1 - 4. )
value a1
1 0.5
-2.9
value b1
1 0.5
2.2
value c1
1 0.5
0.5
value a2
1 0.5
-1.45
value b2
1 0.5
1.95
print
8 1.5
    |    A    |    B    |    C    |
----+---------+---------+---------+
  1 |     -2.9|      2.2|      0.5|
----+---------+---------+---------+
  2 |    -1.45|     1.95|         |
----+---------+---------+---------+
  3 |         |         |         |
----+---------+---------+---------+
// subtotal
// Test Dates of different formats and clearing one cell
clear
0 0
width = 12
1 0
12
a1 = 3/03/03
0 0
display a1
1 0.5
Mar 3, 2003
a1
1 0.5
3/03/03
a2 = 02/2/2002
0 0
display a2
1 0.5
Feb 2, 2002
a3 = 1/1/1901
0 0
display a3
1 0.5
Jan 1, 1901
clear a1
0 0
print
8 1
    |      A     |      B     |      C     |
----+------------+------------+------------+
  1 |            |            |            |
----+------------+------------+------------+
  2 | Feb 2, 2002|            |            |
----+------------+------------+------------+
  3 | Jan 1, 1901|            |            |
----+------------+------------+------------+
// subtotal
// Test negative values, referencing empty cell and average function
clear
0 0
a1 = ( -1 + b1 )
0 0
a2 = ( 2 + b2 )
0 0
b1 = ( c1 )
0 0
c1 = ( 3 / 4 )
0 0
a3 = ( avg a1 - a2 )
0 0
print
8 3
    |      A     |      B     |      C     |
----+------------+------------+------------+
  1 |       -0.25|        0.75|        0.75|
----+------------+------------+------------+
  2 |         2.0|            |            |
----+------------+------------+------------+
  3 |       0.875|            |            |
----+------------+------------+------------+
// subtotal
// Test sum & avg function
clear
0
a1 = 1
0
a2 = 2
0
a3 = -3
0
b1 = ( sum a1 - a3 )
0
a1 = 2
0
value b1
1 2
1.0
a3 = -7
0
c1 = ( avg a1 - a3 )
0
display c1
1 2
-1.0
// subtotal
clear
0
width = 4
1 0
4
a1 = 5
0
b1 = 4
0
c1 = 7
0
a2 = ( sum a1 - c1 )
0
print
8 1
    |  A |  B |  C |
----+----+----+----+
  1 | 5.0| 4.0| 7.0|
----+----+----+----+
  2 |16.0|    |    |
----+----+----+----+
  3 |    |    |    |
----+----+----+----+
// Test larger value of rows and columns
clear
0 0
width = 12
0 0
rows = 20
1 0
20
a20 = ( a1 )
0 0
print
42 0.5
    |      A     |      B     |      C     |
----+------------+------------+------------+
  1 |            |            |            |
----+------------+------------+------------+
  2 |            |            |            |
----+------------+------------+------------+
  3 |            |            |            |
----+------------+------------+------------+
  4 |            |            |            |
----+------------+------------+------------+
  5 |            |            |            |
----+------------+------------+------------+
  6 |            |            |            |
----+------------+------------+------------+
  7 |            |            |            |
----+------------+------------+------------+
  8 |            |            |            |
----+------------+------------+------------+
  9 |            |            |            |
----+------------+------------+------------+
 10 |            |            |            |
----+------------+------------+------------+
 11 |            |            |            |
----+------------+------------+------------+
 12 |            |            |            |
----+------------+------------+------------+
 13 |            |            |            |
----+------------+------------+------------+
 14 |            |            |            |
----+------------+------------+------------+
 15 |            |            |            |
----+------------+------------+------------+
 16 |            |            |            |
----+------------+------------+------------+
 17 |            |            |            |
----+------------+------------+------------+
 18 |            |            |            |
----+------------+------------+------------+
 19 |            |            |            |
----+------------+------------+------------+
 20 |         0.0|            |            |
----+------------+------------+------------+
cols = 25
1 0
25
rows = 2
1 0
2
width = 4
1 0
4
a1 = "did"
0 0
b1 = "you"
0 0
c1 = "pass"
0 0
d1 = "?"
0 0
print
6 0.5
    |  A |  B |  C |  D |  E |  F |  G |  H |  I |  J |  K |  L |  M |  N |  O |  P |  Q |  R |  S |  T |  U |  V |  W |  X |  Y |
----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+
  1 | did| you|pass|   ?|    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |
----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+
  2 |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |    |
----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+----+
// subtotal
// Test sorting integers in a row, decimals in a column
clear
0
rows = 3
0 0
cols = 3
0 0
width = 4
1 0
4
a1 = 5
0
b1 = 4
0
c1 = 7
0
print
8 0
    |  A |  B |  C |
----+----+----+----+
  1 | 5.0| 4.0| 7.0|
----+----+----+----+
  2 |    |    |    |
----+----+----+----+
  3 |    |    |    |
----+----+----+----+
sorta a1 - c1
0
print
8 0.25
    |  A |  B |  C |
----+----+----+----+
  1 | 4.0| 5.0| 7.0|
----+----+----+----+
  2 |    |    |    |
----+----+----+----+
  3 |    |    |    |
----+----+----+----+
sortd a1 - c1
0
print
8 0.25
    |  A |  B |  C |
----+----+----+----+
  1 | 7.0| 5.0| 4.0|
----+----+----+----+
  2 |    |    |    |
----+----+----+----+
  3 |    |    |    |
----+----+----+----+
clear
0 0
rows = 3
0 0
cols = 3
0 0
width = 12
0
a1 = 0.01
0 0
a2 = 0.001
0 0
a3 = 0.1
0 0
print
8 0
    |      A     |      B     |      C     |
----+------------+------------+------------+
  1 |        0.01|            |            |
----+------------+------------+------------+
  2 |       0.001|            |            |
----+------------+------------+------------+
  3 |         0.1|            |            |
----+------------+------------+------------+
sorta a1 - a3
0 0
print
8 0.25
    |      A     |      B     |      C     |
----+------------+------------+------------+
  1 |       0.001|            |            |
----+------------+------------+------------+
  2 |        0.01|            |            |
----+------------+------------+------------+
  3 |         0.1|            |            |
----+------------+------------+------------+
sortd a1 - a3
0 0
print
8 0.25
    |      A     |      B     |      C     |
----+------------+------------+------------+
  1 |         0.1|            |            |
----+------------+------------+------------+
  2 |        0.01|            |            |
----+------------+------------+------------+
  3 |       0.001|            |            |
----+------------+------------+------------+
// subtotal
// Test sorting over a region
clear
0 0
rows = 4
1 0
4
cols = 4
1 0
4
width = 5
1 0
5
a1 = 2
0 0
a2 = 4
0 0
a3 = 1
0 0
b1 = 3
0 0
b2 = 7
0 0
b3 = 8
0 0
c1 = 0.1
0 0
c2 = -2
0 0
c3 = 12
0 0
print
10 0
    |  A  |  B  |  C  |  D  |
----+-----+-----+-----+-----+
  1 |  2.0|  3.0|  0.1|     |
----+-----+-----+-----+-----+
  2 |  4.0|  7.0| -2.0|     |
----+-----+-----+-----+-----+
  3 |  1.0|  8.0| 12.0|     |
----+-----+-----+-----+-----+
  4 |     |     |     |     |
----+-----+-----+-----+-----+
sorta a1 - c3
0 0
print
10 0.5
    |  A  |  B  |  C  |  D  |
----+-----+-----+-----+-----+
  1 | -2.0|  0.1|  1.0|     |
----+-----+-----+-----+-----+
  2 |  2.0|  3.0|  4.0|     |
----+-----+-----+-----+-----+
  3 |  7.0|  8.0| 12.0|     |
----+-----+-----+-----+-----+
  4 |     |     |     |     |
----+-----+-----+-----+-----+
sortd a1 - c3
0 0
print
10 0.5
    |  A  |  B  |  C  |  D  |
----+-----+-----+-----+-----+
  1 | 12.0|  8.0|  7.0|     |
----+-----+-----+-----+-----+
  2 |  4.0|  3.0|  2.0|     |
----+-----+-----+-----+-----+
  3 |  1.0|  0.1| -2.0|     |
----+-----+-----+-----+-----+
  4 |     |     |     |     |
----+-----+-----+-----+-----+
// subtotal
// Test sum/avg over rectangular regions
clear
0 0
a1 = 4.25
0 0
a2 = 5.25
0 0
a3 = 2.225
0 0
b1 = .9
0 0
b2 = ( a2 + a3 )
0 0
a4 = ( sum a1 - b3 )
0 0
b4 = ( avg a1 - b3 )
0 0
print
10 1
    |  A  |  B  |  C  |  D  |
----+-----+-----+-----+-----+
  1 | 4.25|  0.9|     |     |
----+-----+-----+-----+-----+
  2 | 5.25|7.475|     |     |
----+-----+-----+-----+-----+
  3 |2.225|     |     |     |
----+-----+-----+-----+-----+
  4 | 20.1| 3.35|     |     |
----+-----+-----+-----+-----+
// subtotal
// Challenge: Test sorting text or date only
clear
0 0
a1 = "apple"
0 0
a2 = "carrot"
0 0
a3 = "car"
0 0
a4 = "cabbage"
0 0
sortd a1 - a4
0 0
print
10 0.5
    |  A  |  B  |  C  |  D  |
----+-----+-----+-----+-----+
  1 |carro|     |     |     |
----+-----+-----+-----+-----+
  2 |  car|     |     |     |
----+-----+-----+-----+-----+
  3 |cabba|     |     |     |
----+-----+-----+-----+-----+
  4 |apple|     |     |     |
----+-----+-----+-----+-----+
clear
0 0
a1 = 1/1/01
0 0
a2 = 12/1/01
0 0
a3 = 3/1/99
0 0
a4 = 02/02/2020
0 0
sorta a1 - a4
0 0
print
10 0.5
    |  A  |  B  |  C  |  D  |
----+-----+-----+-----+-----+
  1 |Mar 1|     |     |     |
----+-----+-----+-----+-----+
  2 |Jan 1|     |     |     |
----+-----+-----+-----+-----+
  3 |Dec 1|     |     |     |
----+-----+-----+-----+-----+
  4 |Feb 2|     |     |     |
----+-----+-----+-----+-----+
// subtotal
// Challenge: Test operator precedence
a1 = ( 1 + 10 / 2 - 8 / 4 + 2 * 3 )
0 0
value a1
1 2
10.0
// subtotal
// Challenge: Test Parentheses
a1 = 12
0 0
a2 = ( ( 3 - 4 ) * ( a1 - 15 ) / 3 + 2 )
0 0
value a2
1 1
3.0
a3 = ( ( a1 - ( ( a2 + 3 ) * 4 ) ) / 2 + 0.5 )
0 0
value a3
1 1
-5.5
// subtotal
// Challenge: Test function sqrt, log and ^ operator (power)
a2 = ( sqrt 4 )
0 0
value a2
1 1
2.0
a2 = ( 3 ^ 2 )
0 0
value a2
1 0.5
9.0
a3 = ( log 100 )
0 0
value a3
1 0.5
4.605170185988092
// subtotal
// Challenge: Test handling invalid input
clear
0 0
a1 = 1
0 0
b1 = 1
0 0
c1 = 1
0 0
a1 = invalid input
0 0 
b1 = ((
0 0
c1 = a1 = ( sum " - 1
0 0
print
10 1
    |  A  |  B  |  C  |  D  |
----+-----+-----+-----+-----+
  1 |  1.0|  1.0|  1.0|     |
----+-----+-----+-----+-----+
  2 |     |     |     |     |
----+-----+-----+-----+-----+
  3 |     |     |     |     |
----+-----+-----+-----+-----+
  4 |     |     |     |     |
----+-----+-----+-----+-----+
// subtotal
// Challenge: Test Deny sort over a range with self-referencing cells
clear
0 0
rows = 4
1 0
4
cols = 4
1 0
4
width = 5
1 0
5
a1 = 8
0 0
a2 = ( a3 - 4 )
0 0
a3 = ( 5 )
0 0
sorta a1 - a3
0 0
print
10 2
    |  A  |  B  |  C  |  D  |
----+-----+-----+-----+-----+
  1 |  8.0|     |     |     |
----+-----+-----+-----+-----+
  2 |  1.0|     |     |     |
----+-----+-----+-----+-----+
  3 |  5.0|     |     |     |
----+-----+-----+-----+-----+
  4 |     |     |     |     |
----+-----+-----+-----+-----+
// subtotal
// Challenge: Test complex expressions with functions and formulas
clear
0 0
a1 = 2
0 0
a2 = 4
0 0
a3 = ( sqrt 4 + 2 ^ 3 + sum a1 - a2 - 1 )
0 0
value a3
1 1
15.0
// subtotal
// Challenge: Test sorting cells of mixed types
clear
0
rows = 15
1 0
15
cols = 3
1 0
3
width = 12
1 0
12
a1 = 2/2/02
0
a2 = 3
0
a3 = "hello there"
0
a5 = 3/3/01
0
a6 = 2
0
a7 = 9/23/1995
0
a8 = 5
0
a10 = "apple"
0
a12 = 1
0
a13 = "zebra"
0
print
32 0
    |      A     |      B     |      C     |
----+------------+------------+------------+
  1 | Feb 2, 2002|            |            |
----+------------+------------+------------+
  2 |         3.0|            |            |
----+------------+------------+------------+
  3 | hello there|            |            |
----+------------+------------+------------+
  4 |            |            |            |
----+------------+------------+------------+
  5 | Mar 3, 2001|            |            |
----+------------+------------+------------+
  6 |         2.0|            |            |
----+------------+------------+------------+
  7 |Sep 23, 1995|            |            |
----+------------+------------+------------+
  8 |         5.0|            |            |
----+------------+------------+------------+
  9 |            |            |            |
----+------------+------------+------------+
 10 |       apple|            |            |
----+------------+------------+------------+
 11 |            |            |            |
----+------------+------------+------------+
 12 |         1.0|            |            |
----+------------+------------+------------+
 13 |       zebra|            |            |
----+------------+------------+------------+
 14 |            |            |            |
----+------------+------------+------------+
 15 |            |            |            |
----+------------+------------+------------+
sorta a1 - a13
0
print
32 2
    |      A     |      B     |      C     |
----+------------+------------+------------+
  1 |            |            |            |
----+------------+------------+------------+
  2 |            |            |            |
----+------------+------------+------------+
  3 |            |            |            |
----+------------+------------+------------+
  4 |         1.0|            |            |
----+------------+------------+------------+
  5 |         2.0|            |            |
----+------------+------------+------------+
  6 |         3.0|            |            |
----+------------+------------+------------+
  7 |         5.0|            |            |
----+------------+------------+------------+
  8 |Sep 23, 1995|            |            |
----+------------+------------+------------+
  9 | Mar 3, 2001|            |            |
----+------------+------------+------------+
 10 | Feb 2, 2002|            |            |
----+------------+------------+------------+
 11 |       apple|            |            |
----+------------+------------+------------+
 12 | hello there|            |            |
----+------------+------------+------------+
 13 |       zebra|            |            |
----+------------+------------+------------+
 14 |            |            |            |
----+------------+------------+------------+
 15 |            |            |            |
----+------------+------------+------------+
// subtotal
// Challenge: circular references
clear
0
rows = 4
1 0
4
cols = 4
1 0
4
width = 5
1 0
5
a2 = 5
0
a1 = ( a2 )
0 0
a2 = ( a1 )
0 0
expr a2
1 1
5
a2 = ( a3 )
0 0
a3 = 4
0 0
a3 = ( a1 )
0 0
expr a3
1 1
4
// subtotal
// Challenge: Test odd labels
clear
0
rows = 4
0 0
cols = 4
0 0
width = 6
0 0
a1 = "display expr clear print"
0 0
a2 = " = "
0 0
a3 = " save load file "
0 0
a4 = "value a1"
0 0
b1 = "1/2/2022"
0 0
print
10
    |   A  |   B  |   C  |   D  |
----+------+------+------+------+
  1 |displa|1/2/20|      |      |
----+------+------+------+------+
  2 |    = |      |      |      |
----+------+------+------+------+
  3 | save |      |      |      |
----+------+------+------+------+
  4 |value |      |      |      |
----+------+------+------+------+
// subtotal
